# Design Shell

Вы помогаете пользователю спроектировать оболочку приложения — постоянную навигацию и макет, который оборачивает все секции. Это дизайн экрана, а не код реализации.

## Step 1: Check Prerequisites

Сначала проверьте, что существуют предварительные условия:

1. Прочитайте `/product/product-overview.md` — Название и описание продукта
2. Прочитайте `/product/product-roadmap.md` — Секции для навигации
3. Проверьте, существуют ли `/product/design-system/colors.json` и `/product/design-system/typography.json`

Если обзор или дорожная карта отсутствуют:

"Перед проектированием оболочки вам нужно определить ваш продукт и секции. Пожалуйста, запустите:
1. `/product-vision` — Определите ваш продукт
2. `/product-roadmap` — Определите ваши секции"

Остановитесь здесь, если обзор или дорожная карта отсутствуют.

Если токены дизайна отсутствуют, покажите предупреждение, но продолжайте:

"Примечание: Токены дизайна еще не определены. Я продолжу со стилями по умолчанию, но вы можете сначала запустить `/design-tokens` для согласованных цветов и типографики."

## Step 2: Analyze Product Structure

Просмотрите секции дорожной карты и представьте варианты навигации:

"Я проектирую оболочку для **[Product Name]**. Основываясь на вашей дорожной карте, у вас есть [N] секций:

1. **[Section 1]** — [Описание]
2. **[Section 2]** — [Описание]
3. **[Section 3]** — [Описание]

Давайте решим макет оболочки. Общие паттерны:

**A. Боковая навигация** — Вертикальная навигация слева, контент справа
   Лучше для: Приложений со многими секциями, инструментов в стиле дашборда, админ-панелей

**B. Верхняя навигация** — Горизонтальная навигация сверху, контент ниже
   Лучше для: Более простых приложений, продуктов в маркетинговом стиле, меньшего количества секций

**C. Минимальный заголовок** — Только логотип + меню пользователя, секции доступны по-другому
   Лучше для: Инструментов с одной целью, потоков в стиле мастера

Какой паттерн лучше всего подходит для **[Product Name]**?"

Дождитесь их ответа.

## Step 3: Gather Design Details

Используйте AskUserQuestion для уточнения:

- "Где должно появляться меню пользователя (аватар, выход)?"
- "Хотите ли вы, чтобы боковая панель сворачивалась на мобильных, или она должна стать меню-гамбургером?"
- "Есть ли дополнительные элементы в навигации? (Настройки, Справка и т.д.)"
- "Каким должно быть «главное» или представление по умолчанию при загрузке приложения?"

## Step 4: Present Shell Specification

Как только вы поймете их предпочтения:

"Вот дизайн оболочки для **[Product Name]**:

**Паттерн макета:** [Sidebar/Top Nav/Minimal]

**Структура навигации:**
- [Nav Item 1] → [Section]
- [Nav Item 2] → [Section]
- [Nav Item 3] → [Section]
- [Дополнительные элементы, такие как Настройки, Справка]

**Меню пользователя:**
- Расположение: [Вверху справа / Внизу боковой панели]
- Содержимое: Аватар, имя пользователя, выход

**Адаптивное поведение:**
- Настольный: [Как это выглядит]
- Мобильный: [Как это адаптируется]

Соответствует ли это тому, что вы имели в виду?"

Итерируйте до одобрения.

## Step 5: Create the Shell Specification

Создайте `/product/shell/spec.md`:

```markdown
# Application Shell Specification

## Overview
[Описание дизайна оболочки и её назначения]

## Navigation Structure
- [Nav Item 1] → [Section 1]
- [Nav Item 2] → [Section 2]
- [Nav Item 3] → [Section 3]
- [Любые дополнительные элементы навигации]

## User Menu
[Описание расположения и содержимого меню пользователя]

## Layout Pattern
[Описание макета — боковая панель, верхняя навигация и т.д.]

## Responsive Behavior
- **Desktop:** [Поведение]
- **Tablet:** [Поведение]
- **Mobile:** [Поведение]

## Design Notes
[Любые дополнительные решения по дизайну или примечания]
```

## Step 6: Create Shell Components

Создайте компоненты оболочки в `src/shell/components/`:

### AppShell.tsx
Основной компонент-обертка, который принимает children и предоставляет структуру макета.

```tsx
interface AppShellProps {
  children: React.ReactNode
  navigationItems: Array<{ label: string; href: string; isActive?: boolean }>
  user?: { name: string; avatarUrl?: string }
  onNavigate?: (href: string) => void
  onLogout?: () => void
}
```

### MainNav.tsx
Компонент навигации (боковая панель или верхняя навигация в зависимости от выбранного паттерна).

### UserMenu.tsx
Меню пользователя с аватаром и выпадающим списком.

### index.ts
Экспорт всех компонентов.

**Требования к компонентам:**
- Используйте пропсы для всех данных и колбэков (портативно)
- Применяйте токены дизайна, если они существуют (цвета, шрифты)
- Поддерживайте светлый и темный режим с вариантами `dark:`
- Будьте адаптивными для мобильных
- Используйте Tailwind CSS для стилизации
- Используйте lucide-react для иконок

## Step 7: Create Shell Preview

Создайте `src/shell/ShellPreview.tsx` — обертку предпросмотра для просмотра оболочки в Design OS:

```tsx
import data from '@/../product/sections/[first-section]/data.json' // if exists
import { AppShell } from './components/AppShell'

export default function ShellPreview() {
  const navigationItems = [
    { label: '[Section 1]', href: '/section-1', isActive: true },
    { label: '[Section 2]', href: '/section-2' },
    { label: '[Section 3]', href: '/section-3' },
  ]

  const user = {
    name: 'Alex Morgan',
    avatarUrl: undefined,
  }

  return (
    <AppShell
      navigationItems={navigationItems}
      user={user}
      onNavigate={(href) => console.log('Navigate to:', href)}
      onLogout={() => console.log('Logout')}
    >
      <div className="p-8">
        <h1 className="text-2xl font-bold mb-4">Content Area</h1>
        <p className="text-stone-600 dark:text-stone-400">
          Section content will render here.
        </p>
      </div>
    </AppShell>
  )
}
```

## Step 8: Apply Design Tokens

Если токены дизайна существуют, примените их к компонентам оболочки:

**Цвета:**
- Прочитайте `/product/design-system/colors.json`
- Используйте основной цвет для активных элементов навигации, ключевых акцентов
- Используйте вторичный цвет для состояний наведения, тонких выделений
- Используйте нейтральный цвет для фонов, границ, текста

**Типографика:**
- Прочитайте `/product/design-system/typography.json`
- Примените шрифт заголовков к элементам навигации и заголовкам
- Примените шрифт тела к остальному тексту
- Включите импорт Google Fonts в предпросмотр

## Step 9: Confirm Completion

Сообщите пользователю:

"Я спроектировал оболочку приложения для **[Product Name]**:

**Созданные файлы:**
- `/product/shell/spec.md` — Спецификация оболочки
- `src/shell/components/AppShell.tsx` — Основная обертка оболочки
- `src/shell/components/MainNav.tsx` — Компонент навигации
- `src/shell/components/UserMenu.tsx` — Компонент меню пользователя
- `src/shell/components/index.ts` — Экспорты компонентов
- `src/shell/ShellPreview.tsx` — Обертка предпросмотра

**Функции оболочки:**
- Макет [Layout pattern]
- Навигация для всех [N] секций
- Меню пользователя с аватаром и выходом
- Адаптивный дизайн для мобильных
- Поддержка светлого/темного режима

**Важно:** Перезапустите ваш dev server, чтобы увидеть изменения.

Когда вы проектируете экраны секций с `/design-screen`, они будут отображаться внутри этой оболочки, показывая полный опыт приложения.

Далее: Запустите `/shape-section` для начала проектирования вашей первой секции."

## Important Notes

- Оболочка — это дизайн экрана — она демонстрирует дизайн навигации и макета
- Компоненты на основе пропсов и портативны в кодовую базу пользователя
- Обертка предпросмотра только для Design OS — не экспортируется
- Применяйте токены дизайна, когда доступны, для согласованной стилизации
- Держите оболочку сфокусированной на навигационном хроме — без UI аутентификации
- Дизайны экранов секций будут отображаться внутри области контента оболочки
